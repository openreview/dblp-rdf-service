
# Goal Overview
For every person/author profile in OpenReview, supplement their set of authored
papers by identifying them in DBLP and uploading any dblp records (as new notes)
that are not already recorded present. As dblp.org updates their database with
new papers, add those papers as new entries into OpenReview, linked to their
respective authors by id, e.g., ~Adam_Smith1.

## Currently implemented procedure

The following table is a visualization of the data that is retrieved, examined,
and amended if necessary. No actual table is created in the current
implementation.

The table is built as follows:

- Starting with an authorID, e.g., ~Sebastian_Thrun1
- Fetch the openreview author profile, which contains a field like
   `{content.dblp: 'https://dblp.org/pid/m/SebastianThrun'}`
- Normalize the value of content.dblp
  - A GET is performed on the content.dblp URL, following any redirects, until
    the final URL is reached, and is the normalized dblp author URL.
- Derive the authorPID from authorURL, e.g., /m/SebastianThrun

- Populate the table
  - /notes column data is generated by querying openreview for all papers
    attributed to the profile author
  - dblp.org column data is generated by fetching from content.dblp, e.g.,
    https://dblp.org/pid/m/SebastianThrun.html
    - dblp.org column's authorIndex field is generated by pid comparison between dblp entry and authorPID
  - /notes and dblp.org columns are row-aligned by exact title matches between
    the papers
  - /search column is generated (as needed), by exact title search in openreview

```
|------------------------+----------------+-----------------------------|
| /notes                 | /search        | dblp.org                    |
|------------------------+----------------+-----------------------------|
| note:                  | same as /notes | title: Thrun P20...         |
| _id: note#1            |                | authorIndex: 2              |
| _content:              |                | note: {                     |
| __title: 'Thrun P20..' |                | _content: {                 |
| __authorids: []        |                | __dblp: http://.../ThrunP20 |
|                        |                | ...                         |
|------------------------+----------------+-----------------------------|
| *note#2 w/o dblp entry |                |                             |
|------------------------+----------------+-----------------------------|
|                        | *possible      | dblp entry w/o note         |
|                        | title match    |                             |
|                        |                |                             |
|------------------------+----------------+-----------------------------|
```

- Procedure:
  - Consider only those rows that have a dblp.org entry, but no /notes entry
  - perform a title search in openreview using dblp entry
    - if matching paper is found with the Profile author in its author list
      (e.g., 'Sebastian Thrun') POST an update to the openreview note with
      content.authors updated to contain the id (~Sebastian_Thrun1) for the
      profile author
    - if matching paper is found w/o an author name match, OR if no paper is found
      - POST a new paper to /note endpoint and then update it to include the
        correct authorID

Note: updates POSTed to openreview are done using the /references endpoint to
create a record with field 'referent' set to the note.id, *not* by posting to
the original note

### Questions about current procedure
- When creating new notes for dblp records, should content include title/authors field?
  - Currently only the content.dblp and content.authorids field are created, as
    per the examples below.
  - Given that /search is based on title, if a paper is inserted for, say,
    author#1, then author#2 will not be able to find that same record and insert
    their id into authorids field.

- Should note _bibtex field be populated (or any other content fields that can
  be derived from dblp)?
  - if so, just in newly created notes, or backfill any missing in old notes?

- Current system seems to only upload new papers if there are no papers of any
  kind for that author. Is this still the desired behavior?

- Author's dblp URL is normalized through repeated GETs to dblp.org. The
  final URL is not POSTed back to OpenReview, however. Should the normalized
  URL be recorded, to avoid future requests to dblp.org?


## Proposed expanded procedure
The current procedure will be run, at regular intervals, with several
modifications:

- A local data store will replace any fetch calls to dblp.org
  - updated data files will be downloaded from dblp.org on a regular basis
- A method for selecting which author profiles to process on each run will be
  introduced
    - Authors will require updating in two cases
        - Newly downloaded records from dblp.org may contain new papers for
          existing authors
        - Newly created/modified openreview profiles may introduce a new
          content.dblp field



### Examples
The structure of a note that is newly created when a new dblp entry is found:
```
  note: {
    content: {
      dblp: publicationNode.toString()
    },
    invitation: 'dblp.org/-/record',
    readers: ['everyone'],
    writers: ['dblp.org'],
    signatures: ['dblp.org']
  },
```

The structure of the /reference that is used to update a note
```

  let updateNoteObject = {
    id: referenceId,
    referent: paperId,
    invitation: 'dblp.org/-/author_coreference',
    signatures: ['dblp.org'],
    readers: ['everyone'],
    writers: [],
    content: {
      authorids: authorIds
    }
```
